################################################################################
#                               Filename output                                #
################################################################################

NAME		=	ft_ping

################################################################################
#                         Sources and objects directories                      #
################################################################################

SRCS_DIR = srcs
OBJS_DIR = objects-dependances
DEPS_DIR = $(OBJS_DIR)

################################################################################
#                               Sources filenames                              #
################################################################################

C_FILES = $(shell find $(SRCS_DIR) -name '*.c')

################################################################################
#                              Commands and arguments                          #
################################################################################

CC			=	gcc
CFLAGS		=	-Wall -Wextra -Werror -g3
RM			=	rm -rf

################################################################################
#                                 Defining colors                              #
################################################################################

_RED		=	\033[31m
_GREEN		=	\033[32m
_YELLOW		=	\033[33m
_CYAN		=	\033[36m
_NC			=	\033[0m

################################################################################
#                                    Objects                                   #
################################################################################

C_OBJS = $(patsubst $(SRCS_DIR)/%.c,$(OBJS_DIR)/%.o,$(C_FILES))

################################################################################
#                                  DÃ©pendances                                 #
################################################################################

C_DEPS = $(patsubst $(OBJS_DIR)/%.o,$(DEPS_DIR)/%.d,$(C_OBJS))

################################################################################
#                               Commands and rules                             #
################################################################################

all: init $(NAME)

init:
	@echo "$(_CYAN)Creating directories if not existing...$(_NC)"
	@mkdir -p $(OBJS_DIR)
	@mkdir -p $(DEPS_DIR)

$(OBJS_DIR)/%.o: $(SRCS_DIR)/%.c
	@echo "$(_YELLOW)Compiling $<...$(_NC)"
	@$(CC) $(CFLAGS) -c $< -o $@

$(DEPS_DIR)/%.d: $(SRCS_DIR)/%.c
	@$(CC) $(CFLAGS) -MM $< -MT $(@:.d=.o) -MF $@

$(NAME): $(C_OBJS)
	@echo "$(_GREEN)Linking $@...$(_NC)"
	@$(CC) $(CFLAGS) $(C_OBJS) -o $(NAME) -lm
	@echo "$(_GREEN)$(NAME) created successfully!$(_NC)"

clean:
	@echo "$(_RED)Cleaning up object and dependency files...$(_NC)"
	@$(RM) $(OBJS_DIR)

fclean: clean
	@echo "$(_RED)Cleaning up the executable...$(_NC)"
	@$(RM) $(NAME)

re: fclean all

################################################################################
#                               Special commands                               #
################################################################################

.PHONY: all clean fclean re
-include $(C_DEPS)
